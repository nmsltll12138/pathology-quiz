import streamlit as st

# =========================
# 题库（严格：list[dict]）
# 每道题：question / options / answer / explanation
# 每章 15 题（共 12 章 * 15 = 180 题）
# =========================
import json
from pathlib import Path
import streamlit as st

@st.cache_data
def load_quiz():
    p = Path(__file__).parent / "data" / "quiz_all_courses.json"
    with open(p, "r", encoding="utf-8") as f:
        return json.load(f)

quiz_data = load_quiz()


# -------------------------
# 第1章 细胞和组织的适应与损伤（15）
# -------------------------
quiz_data += [
    {
        "question": "【第1章】“变性”最恰当的理解是？",
        "options": [
            "细胞发生可逆性代谢障碍导致的形态学改变",
            "细胞发生不可逆性死亡并被清除",
            "细胞数量异常增多导致组织体积增大",
            "细胞分化方向改变并形成肿瘤"
        ],
        "answer": "细胞发生可逆性代谢障碍导致的形态学改变",
        "explanation": "变性通常指可逆性细胞损伤，表现为代谢紊乱及相应形态改变。"
    },
    {
        "question": "【第1章】细胞水肿（细胞肿胀）最常见的机制是？",
        "options": [
            "线粒体氧化磷酸化增强",
            "Na⁺/K⁺-ATP 酶功能受损导致离子/水进入细胞",
            "细胞内蛋白合成加速导致渗透压下降",
            "溶酶体膜稳定性增强"
        ],
        "answer": "Na⁺/K⁺-ATP 酶功能受损导致离子/水进入细胞",
        "explanation": "能量不足→膜泵障碍→Na⁺、水进入细胞→细胞水肿。"
    },
    {
        "question": "【第1章】脂肪变性最常见发生于下列哪个器官？",
        "options": ["肝脏", "骨骼肌", "脾脏", "甲状腺"],
        "answer": "肝脏",
        "explanation": "肝细胞脂代谢活跃，缺氧、毒物、营养失衡等可致脂肪变性。"
    },
    {
        "question": "【第1章】玻璃样变性常见的形态学特点是？",
        "options": [
            "细胞内大量脂滴空泡",
            "组织呈均质、嗜酸性、半透明样改变",
            "组织内形成大量气体空腔",
            "大量含铁血黄素颗粒沉积"
        ],
        "answer": "组织呈均质、嗜酸性、半透明样改变",
        "explanation": "玻璃样变性表现为均质嗜酸、透明样物质沉积或变性。"
    },
    {
        "question": "【第1章】病理性色素沉着中，含铁血黄素沉着最常与哪种情况相关？",
        "options": ["慢性淤血或出血后", "维生素缺乏", "胶原合成增加", "细胞核分裂增多"],
        "answer": "慢性淤血或出血后",
        "explanation": "红细胞分解→铁回收→含铁血黄素在组织/巨噬细胞内沉着。"
    },
    {
        "question": "【第1章】“病理性钙化”中，营养不良性钙化最典型的发生背景是？",
        "options": [
            "血钙增高",
            "坏死或变性的组织中钙盐沉积且血钙正常",
            "甲状旁腺功能亢进",
            "维生素D过量导致骨质脱钙"
        ],
        "answer": "坏死或变性的组织中钙盐沉积且血钙正常",
        "explanation": "营养不良性钙化与局部坏死/变性有关，常见于结核灶、粥样斑块等。"
    },
    {
        "question": "【第1章】凝固性坏死最常见于以下哪类组织/器官？",
        "options": ["心肌/肾等实质器官", "脑组织", "胰腺脂肪组织", "骨髓"],
        "answer": "心肌/肾等实质器官",
        "explanation": "缺血缺氧导致蛋白变性为主，组织轮廓短期保留，典型于心肌梗死。"
    },
    {
        "question": "【第1章】液化性坏死最典型见于？",
        "options": ["脑梗死", "脾梗死", "肾梗死", "肺梗死"],
        "answer": "脑梗死",
        "explanation": "脑组织富含脂质与水解酶作用明显，缺血后易液化。"
    },
    {
        "question": "【第1章】干酪样坏死最常提示哪类疾病？",
        "options": ["结核病", "病毒性肝炎", "支气管哮喘", "动脉粥样硬化"],
        "answer": "结核病",
        "explanation": "干酪样坏死是结核等肉芽肿性炎的典型坏死形态。"
    },
    {
        "question": "【第1章】脂肪坏死与下列哪种疾病关系最密切？",
        "options": ["急性胰腺炎", "慢性胃炎", "急性肾盂肾炎", "大叶性肺炎"],
        "answer": "急性胰腺炎",
        "explanation": "胰脂肪酶外溢→脂肪分解→与钙结合形成皂化。"
    },
    {
        "question": "【第1章】纤维素样坏死常见于？",
        "options": ["免疫性血管炎/高血压小动脉损伤", "肝细胞脂肪变", "脑组织液化", "胃黏膜糜烂"],
        "answer": "免疫性血管炎/高血压小动脉损伤",
        "explanation": "血管壁坏死伴纤维素样物质沉积，常与免疫损伤或严重高血压相关。"
    },
    {
        "question": "【第1章】细胞凋亡在光镜下更典型的形态学特点是？",
        "options": [
            "细胞肿胀破裂并引发明显炎症",
            "细胞皱缩、核固缩/碎裂形成凋亡小体，炎症反应轻",
            "组织结构完全保留且无核变化",
            "细胞间连接增强导致细胞层增厚"
        ],
        "answer": "细胞皱缩、核固缩/碎裂形成凋亡小体，炎症反应轻",
        "explanation": "凋亡是程序性细胞死亡，常不引起明显炎症。"
    },
    {
        "question": "【第1章】萎缩的正确描述是？",
        "options": [
            "细胞体积或数量减少导致器官体积缩小",
            "细胞数量增多导致器官增大",
            "细胞分化方向改变形成另一种成熟细胞",
            "细胞外基质增多导致组织变硬"
        ],
        "answer": "细胞体积或数量减少导致器官体积缩小",
        "explanation": "萎缩可由失用、缺血、营养不良、内分泌减少等引起。"
    },
    {
        "question": "【第1章】“肥大”与“增生”最主要的区别是？",
        "options": [
            "肥大：细胞体积增大；增生：细胞数量增多",
            "肥大：细胞数量增多；增生：细胞体积增大",
            "两者都仅发生于永久细胞",
            "两者都必然发展为肿瘤"
        ],
        "answer": "肥大：细胞体积增大；增生：细胞数量增多",
        "explanation": "肥大偏“变大”，增生偏“变多”，可同时出现（如子宫）。"
    },
    {
        "question": "【第1章】“化生”的最恰当定义是？",
        "options": [
            "一种成熟细胞被另一种成熟细胞替代的可逆性适应性改变",
            "细胞发生不可逆性坏死",
            "异常新生物的形成",
            "组织中胶原大量沉积形成瘢痕"
        ],
        "answer": "一种成熟细胞被另一种成熟细胞替代的可逆性适应性改变",
        "explanation": "化生多与慢性刺激相关，如支气管柱状上皮→鳞状上皮化生。"
    },
]

# -------------------------
# 第2章 损伤的修复（15）
# -------------------------
quiz_data += [
    {
        "question": "【第2章】“再生”最准确的表述是？",
        "options": [
            "损伤后由同类细胞增殖恢复原有结构与功能",
            "损伤后全部由瘢痕组织替代",
            "损伤后形成肿瘤样新生物",
            "损伤后发生钙盐沉积使组织变硬"
        ],
        "answer": "损伤后由同类细胞增殖恢复原有结构与功能",
        "explanation": "再生强调“同类细胞补充”，尽可能恢复原结构功能。"
    },
    {
        "question": "【第2章】下列哪类细胞的再生能力最强（易再生）？",
        "options": ["不稳定细胞（如表皮、消化道上皮）", "稳定细胞（如肝细胞）", "永久细胞（如心肌细胞）", "神经元"],
        "answer": "不稳定细胞（如表皮、消化道上皮）",
        "explanation": "不稳定细胞持续分裂更新，再生能力最强。"
    },
    {
        "question": "【第2章】肉芽组织的主要组成成分是？",
        "options": [
            "新生毛细血管 + 成纤维细胞 + 炎细胞",
            "大量成熟胶原纤维 + 极少细胞",
            "坏死组织碎片 + 钙盐沉积",
            "脂肪细胞 + 骨小梁"
        ],
        "answer": "新生毛细血管 + 成纤维细胞 + 炎细胞",
        "explanation": "肉芽组织是修复早期典型组织，血管丰富、质地柔软、易出血。"
    },
    {
        "question": "【第2章】肉芽组织在创伤修复中的主要作用不包括？",
        "options": ["填补组织缺损", "提供新生血管供氧供营养", "产生胶原并形成瘢痕基础", "直接杀灭全部病原体而无需免疫参与"],
        "answer": "直接杀灭全部病原体而无需免疫参与",
        "explanation": "肉芽组织以修复为主；抗感染需要炎症/免疫系统共同作用。"
    },
    {
        "question": "【第2章】瘢痕组织的典型形态学特点是？",
        "options": [
            "胶原纤维丰富、细胞和血管较少",
            "新生毛细血管极多且易出血",
            "大量中性粒细胞浸润",
            "脂滴充满细胞质"
        ],
        "answer": "胶原纤维丰富、细胞和血管较少",
        "explanation": "瘢痕是修复后期表现：致密胶原、血供少、弹性差。"
    },
    {
        "question": "【第2章】“机化”更常用于描述哪种过程？",
        "options": [
            "炎性渗出物/血栓/坏死组织被肉芽组织长入并最终纤维化",
            "细胞发生脂肪变性",
            "肿瘤细胞发生远处转移",
            "组织发生干酪样坏死"
        ],
        "answer": "炎性渗出物/血栓/坏死组织被肉芽组织长入并最终纤维化",
        "explanation": "机化是“长入—纤维化”的过程，常见于血栓、肺炎渗出物等。"
    },
    {
        "question": "【第2章】一期愈合（原发愈合）更符合哪种伤口特点？",
        "options": [
            "切口整齐、组织缺损小、感染少",
            "组织缺损大、边缘不整齐",
            "明显感染与坏死组织多",
            "需要大量肉芽组织填充"
        ],
        "answer": "切口整齐、组织缺损小、感染少",
        "explanation": "一期愈合瘢痕小、愈合快；二期愈合则缺损大、肉芽组织多。"
    },
    {
        "question": "【第2章】创伤愈合的一般过程顺序更符合？",
        "options": [
            "炎症反应期 → 增生/肉芽组织期 → 重塑成熟期",
            "钙化期 → 坏死期 → 化生期",
            "肿瘤形成期 → 转移期 → 分化期",
            "脂肪变性期 → 玻璃样变期 → 淀粉样变期"
        ],
        "answer": "炎症反应期 → 增生/肉芽组织期 → 重塑成熟期",
        "explanation": "经典分期：清除坏死/病原→修复填补→胶原重塑成熟。"
    },
    {
        "question": "【第2章】影响创伤愈合的局部不利因素不包括？",
        "options": ["感染", "异物残留", "局部血供差", "适当无张力对合缝合"],
        "answer": "适当无张力对合缝合",
        "explanation": "良好的对合、减少张力有利于愈合；感染、缺血等会延迟愈合。"
    },
    {
        "question": "【第2章】全身因素中，最容易导致伤口愈合延迟的是？",
        "options": ["糖尿病/营养不良", "适度运动", "足量蛋白摄入", "良好睡眠"],
        "answer": "糖尿病/营养不良",
        "explanation": "高血糖影响免疫与微循环；营养不良缺乏修复原料。"
    },
    {
        "question": "【第2章】骨折愈合的基本过程通常包括？",
        "options": [
            "血肿形成 → 纤维/软骨痂 → 骨痂形成与改建",
            "脂肪变性 → 玻璃样变性 → 钙化",
            "急性炎症 → 干酪样坏死 → 空洞形成",
            "血栓形成 → 栓塞 → 梗死"
        ],
        "answer": "血肿形成 → 纤维/软骨痂 → 骨痂形成与改建",
        "explanation": "骨折愈合需要血肿与炎症启动，随后形成骨痂并逐渐改建。"
    },
    {
        "question": "【第2章】下列哪项更符合“过度修复”的临床/形态学表现？",
        "options": ["瘢痕疙瘩（瘢痕增生明显）", "无瘢痕愈合", "组织完全再生", "坏死灶扩大"],
        "answer": "瘢痕疙瘩（瘢痕增生明显）",
        "explanation": "过度修复可出现瘢痕增生或瘢痕疙瘩。"
    },
    {
        "question": "【第2章】“永久细胞”的特点更符合？",
        "options": [
            "分化成熟后基本不再分裂，再生能力弱",
            "持续快速分裂更新",
            "轻微刺激即可大量增殖",
            "主要通过化生方式完成再生"
        ],
        "answer": "分化成熟后基本不再分裂，再生能力弱",
        "explanation": "如心肌细胞、神经元等，损伤后多以瘢痕修复为主。"
    },
    {
        "question": "【第2章】肉芽组织与炎性肉芽肿（结核结节）最关键的区别是？",
        "options": [
            "肉芽组织用于修复，血管丰富；肉芽肿为慢性炎症反应性结节",
            "两者完全同义",
            "肉芽组织仅见于肿瘤内部",
            "肉芽肿只在急性炎症早期出现"
        ],
        "answer": "肉芽组织用于修复，血管丰富；肉芽肿为慢性炎症反应性结节",
        "explanation": "肉芽组织是修复组织；炎性肉芽肿是特定慢性炎症形态。"
    },
    {
        "question": "【第2章】“再通”最常用于描述哪种修复结局？",
        "options": ["机化的血栓内形成新生小血管腔", "坏死灶发生钙化", "肿瘤发生远处转移", "炎症渗出完全液化"],
        "answer": "机化的血栓内形成新生小血管腔",
        "explanation": "血栓机化过程中可出现新生管腔贯通，称再通。"
    },
]

# -------------------------
# 第3章 局部血液循环障碍（15）
# -------------------------
quiz_data += [
    {
        "question": "【第3章】动脉性充血的主要机制是？",
        "options": ["小动脉扩张导致局部血流量增加", "静脉回流受阻", "血液大量外渗到组织间隙", "局部动脉闭塞导致缺血"],
        "answer": "小动脉扩张导致局部血流量增加",
        "explanation": "动脉性充血多见于炎症、代偿或神经体液因素引起的小动脉扩张。"
    },
    {
        "question": "【第3章】淤血（静脉性充血）的本质是？",
        "options": ["静脉回流受阻导致局部血量增多", "动脉扩张导致血流增加", "血管内形成血栓导致缺血", "血液进入体腔形成积液"],
        "answer": "静脉回流受阻导致局部血量增多",
        "explanation": "淤血常因静脉回流障碍（心衰、静脉压迫等）引起。"
    },
    {
        "question": "【第3章】慢性肺淤血（长期左心衰）可出现的典型改变是？",
        "options": ["棕色硬化与“心衰细胞”", "干酪样坏死", "大量脂肪变性", "大量脓肿形成"],
        "answer": "棕色硬化与“心衰细胞”",
        "explanation": "慢性肺淤血：肺泡出血→含铁血黄素巨噬细胞（心衰细胞）+间质纤维化。"
    },
    {
        "question": "【第3章】慢性肝淤血（长期右心衰）的大体特征常描述为？",
        "options": ["槟榔肝", "肝硬化结节肝", "脂肪肝", "肝脓肿"],
        "answer": "槟榔肝",
        "explanation": "肝小叶中央静脉区淤血/坏死与周边脂肪变性相间，呈槟榔样。"
    },
    {
        "question": "【第3章】血栓形成的三大条件（Virchow三要素）是？",
        "options": [
            "血管内皮损伤、血流状态改变、血液高凝状态",
            "细菌感染、免疫缺陷、遗传突变",
            "血压升高、血脂升高、血糖升高",
            "组织缺氧、酸中毒、电解质紊乱"
        ],
        "answer": "血管内皮损伤、血流状态改变、血液高凝状态",
        "explanation": "三要素是血栓形成的核心机制框架。"
    },
    {
        "question": "【第3章】白色血栓更常见于？",
        "options": ["高流速动脉或心腔", "静脉下肢深静脉", "毛细血管外组织间隙", "胆囊腔内"],
        "answer": "高流速动脉或心腔",
        "explanation": "白色血栓以血小板和纤维蛋白为主，多见于动脉/心腔等高流速处。"
    },
    {
        "question": "【第3章】混合血栓的典型结构特征是？",
        "options": ["层状结构（血小板纤维蛋白与红细胞交替）", "完全由脂滴构成", "完全由细菌构成", "完全由钙盐构成"],
        "answer": "层状结构（血小板纤维蛋白与红细胞交替）",
        "explanation": "层状条纹（Zahn线）提示生前血栓形成。"
    },
    {
        "question": "【第3章】下列哪项属于血栓的常见结局？",
        "options": ["溶解、机化、再通、脱落形成栓子", "必然钙化并形成肿瘤", "全部转化为干酪样坏死", "全部变为脂肪组织"],
        "answer": "溶解、机化、再通、脱落形成栓子",
        "explanation": "血栓可被溶解、机化纤维化、再通或脱落导致栓塞。"
    },
    {
        "question": "【第3章】“栓塞”的定义是？",
        "options": [
            "循环中的栓子阻塞血管引起局部缺血/坏死",
            "血管内皮损伤导致局部血小板聚集",
            "静脉回流受阻导致局部淤血",
            "体腔内出现异常积液"
        ],
        "answer": "循环中的栓子阻塞血管引起局部缺血/坏死",
        "explanation": "栓子可为血栓、脂肪、气体、羊水等，阻塞血管造成损害。"
    },
    {
        "question": "【第3章】静脉血栓栓塞最常到达的器官是？",
        "options": ["肺", "脑", "肾", "脾"],
        "answer": "肺",
        "explanation": "下肢/盆腔静脉血栓脱落→右心→肺动脉，引起肺栓塞。"
    },
    {
        "question": "【第3章】大量肺动脉栓塞最严重的后果是？",
        "options": ["急性右心衰/猝死", "肝硬化", "慢性胃炎", "肾结石"],
        "answer": "急性右心衰/猝死",
        "explanation": "大栓子堵塞肺动脉主干可致急性循环衰竭甚至猝死。"
    },
    {
        "question": "【第3章】“梗死”的定义是？",
        "options": [
            "因动脉阻塞或静脉回流障碍导致组织局灶性缺血坏死",
            "局部炎症导致充血水肿",
            "组织发生化生",
            "细胞发生脂肪变性"
        ],
        "answer": "因动脉阻塞或静脉回流障碍导致组织局灶性缺血坏死",
        "explanation": "梗死本质是缺血坏死，多由栓塞/血栓引起。"
    },
    {
        "question": "【第3章】白色（贫血性）梗死更常见于？",
        "options": ["脾、肾等实质器官（终末动脉供血）", "肺组织", "小肠黏膜", "皮肤浅表"],
        "answer": "脾、肾等实质器官（终末动脉供血）",
        "explanation": "终末动脉供血的致密器官缺血后出血少，形成白色梗死。"
    },
    {
        "question": "【第3章】红色（出血性）梗死更可能发生在？",
        "options": ["肺（双重血供且组织疏松）", "肾皮质", "脾", "心肌"],
        "answer": "肺（双重血供且组织疏松）",
        "explanation": "组织疏松/双重血供或静脉阻塞时，梗死区易出血呈红色。"
    },
    {
        "question": "【第3章】败血性梗死最主要的特点是？",
        "options": ["梗死灶被细菌感染，易形成脓肿", "必然发生钙化", "必然发生脂肪变性", "仅发生于脑组织"],
        "answer": "梗死灶被细菌感染，易形成脓肿",
        "explanation": "感染性栓子导致的梗死可继发化脓，称败血性梗死。"
    },
]

# -------------------------
# 第4章 炎症（15）
# -------------------------
quiz_data += [
    {
        "question": "【第4章】炎症的本质最恰当的表述是？",
        "options": [
            "机体对损伤因子产生的以血管反应为中心的防御反应",
            "细胞数量异常增生形成肿块",
            "局部血流减少导致缺血坏死",
            "组织发生化生以适应环境"
        ],
        "answer": "机体对损伤因子产生的以血管反应为中心的防御反应",
        "explanation": "炎症是防御性反应，核心是血管反应与炎细胞反应。"
    },
    {
        "question": "【第4章】炎症的基本病理过程通常概括为？",
        "options": ["变质、渗出、增生", "萎缩、肥大、化生", "栓塞、梗死、出血", "变性、坏死、钙化"],
        "answer": "变质、渗出、增生",
        "explanation": "变质反映损伤，渗出反映血管反应，增生反映修复/慢性过程。"
    },
    {
        "question": "【第4章】“渗出液”与“漏出液”最关键的区别依据是？",
        "options": ["蛋白含量高、细胞多（渗出） vs 蛋白低、细胞少（漏出）", "颜色是否发红", "是否有气味", "是否发生在体表"],
        "answer": "蛋白含量高、细胞多（渗出） vs 蛋白低、细胞少（漏出）",
        "explanation": "渗出多由血管通透性增高；漏出多由静水压/胶体渗透压改变。"
    },
    {
        "question": "【第4章】急性炎症早期血管反应最典型的变化是？",
        "options": ["小血管扩张与通透性增高", "小血管痉挛持续不缓解", "静脉完全闭塞", "动脉内形成大量血栓"],
        "answer": "小血管扩张与通透性增高",
        "explanation": "扩张导致充血，通透性增高导致蛋白与液体外渗。"
    },
    {
        "question": "【第4章】浆液性炎更常见的例子是？",
        "options": ["皮肤水疱/浆膜腔积液", "肺脓肿", "白喉假膜", "阑尾脓肿"],
        "answer": "皮肤水疱/浆膜腔积液",
        "explanation": "浆液性炎以浆液渗出为主，液体较清亮、细胞成分少。"
    },
    {
        "question": "【第4章】纤维素性炎的主要特征是？",
        "options": [
            "渗出物中纤维蛋白原大量渗出并形成纤维蛋白",
            "以大量脂滴为主",
            "以大量钙盐沉积为主",
            "以大量红细胞为主且无纤维蛋白"
        ],
        "answer": "渗出物中纤维蛋白原大量渗出并形成纤维蛋白",
        "explanation": "见于浆膜、黏膜等，重者可形成假膜，吸收不全可机化。"
    },
    {
        "question": "【第4章】化脓性炎的主要细胞成分是？",
        "options": ["中性粒细胞", "嗜酸性粒细胞", "淋巴细胞", "嗜碱性粒细胞"],
        "answer": "中性粒细胞",
        "explanation": "化脓性炎常由化脓菌引起，以中性粒细胞浸润和脓液形成为特征。"
    },
    {
        "question": "【第4章】脓肿形成最恰当的描述是？",
        "options": ["局部组织液化坏死形成含脓腔隙，周围常有肉芽组织/纤维包绕", "局部组织凝固性坏死且无炎细胞", "局部形成干酪样坏死结节", "局部发生钙盐沉积形成硬结"],
        "answer": "局部组织液化坏死形成含脓腔隙，周围常有肉芽组织/纤维包绕",
        "explanation": "脓肿是化脓性炎的局灶性表现，典型为液化坏死+脓液。"
    },
    {
        "question": "【第4章】出血性炎更常提示？",
        "options": ["炎症损伤严重、血管壁破坏明显", "炎症轻微且快速痊愈", "仅见于慢性炎症", "与细菌无关仅与病毒有关"],
        "answer": "炎症损伤严重、血管壁破坏明显",
        "explanation": "出血性炎说明血管损伤重，红细胞大量渗出。"
    },
    {
        "question": "【第4章】急性炎症最常见的结局不包括？",
        "options": ["完全恢复", "化脓", "机化/纤维化", "必然发展为肿瘤"],
        "answer": "必然发展为肿瘤",
        "explanation": "炎症可恢复、化脓、迁延成慢性或机化，但不必然形成肿瘤。"
    },
    {
        "question": "【第4章】炎症介质中，组胺（histamine）的主要作用是？",
        "options": ["引起血管扩张并增加血管通透性", "直接促进胶原大量合成", "抑制白细胞趋化", "使血管持续痉挛"],
        "answer": "引起血管扩张并增加血管通透性",
        "explanation": "组胺是急性炎症早期重要介质，来自肥大细胞、嗜碱细胞等。"
    },
    {
        "question": "【第4章】炎性肉芽肿的基本概念是？",
        "options": [
            "以巨噬细胞（上皮样细胞）聚集为主的慢性炎症性结节",
            "以中性粒细胞为主的急性炎症灶",
            "以纤维蛋白渗出为主的假膜",
            "以大量红细胞渗出为主的炎症"
        ],
        "answer": "以巨噬细胞（上皮样细胞）聚集为主的慢性炎症性结节",
        "explanation": "肉芽肿常见于结核、异物反应等，属于慢性炎症的特殊形态。"
    },
    {
        "question": "【第4章】结核性肉芽肿更典型的细胞成分组合是？",
        "options": ["上皮样细胞 + 郎罕巨细胞 + 淋巴细胞，常伴干酪样坏死", "中性粒细胞为主", "大量嗜酸性粒细胞为主", "纤维蛋白为主且无细胞"],
        "answer": "上皮样细胞 + 郎罕巨细胞 + 淋巴细胞，常伴干酪样坏死",
        "explanation": "免疫性肉芽肿常由T细胞介导，典型如结核。"
    },
    {
        "question": "【第4章】慢性炎症常见的组织学特点是？",
        "options": ["单核细胞浸润（淋巴细胞/浆细胞/巨噬细胞）+ 组织增生修复", "仅见大量中性粒细胞", "仅见纤维蛋白渗出", "仅见红细胞渗出"],
        "answer": "单核细胞浸润（淋巴细胞/浆细胞/巨噬细胞）+ 组织增生修复",
        "explanation": "慢性炎症以单核细胞浸润、组织破坏与修复（纤维化/血管新生）并存为特征。"
    },
    {
        "question": "【第4章】炎症的五大局部表现（红肿热痛 + 功能障碍）中，“红”和“热”最主要原因是？",
        "options": ["局部充血（血流增加）", "局部缺血", "局部钙化", "局部脂肪变性"],
        "answer": "局部充血（血流增加）",
        "explanation": "血管扩张→血流增多→红、热；渗出与细胞反应导致肿、痛、功能障碍。"
    },
]

# -------------------------
# 第5章 肿瘤（15）
# -------------------------
quiz_data += [
    {
        "question": "【第5章】肿瘤最恰当的定义是？",
        "options": [
            "机体细胞在致癌因素作用下发生异常增殖并失去正常调控的疾病",
            "任何局部炎症性肿胀",
            "任何器官体积增大",
            "任何细胞可逆性变性"
        ],
        "answer": "机体细胞在致癌因素作用下发生异常增殖并失去正常调控的疾病",
        "explanation": "肿瘤的核心是“自主性、失控性增殖”。"
    },
    {
        "question": "【第5章】良性肿瘤最常见的生长方式是？",
        "options": ["膨胀性生长，常有包膜", "浸润性破坏周围组织", "早期即广泛转移", "沿神经鞘广泛播散"],
        "answer": "膨胀性生长，常有包膜",
        "explanation": "良性肿瘤多生长缓慢、边界清、压迫周围组织。"
    },
    {
        "question": "【第5章】恶性肿瘤最重要的生物学特征之一是？",
        "options": ["浸润与转移", "一定形成包膜", "一定不复发", "一定分泌激素"],
        "answer": "浸润与转移",
        "explanation": "浸润性生长与转移是恶性肿瘤危害性的关键。"
    },
    {
        "question": "【第5章】肿瘤异型性主要反映了？",
        "options": ["分化程度与恶性程度", "炎症程度", "血栓形成倾向", "钙化程度"],
        "answer": "分化程度与恶性程度",
        "explanation": "异型性越明显，分化越差，通常恶性度越高。"
    },
    {
        "question": "【第5章】下列哪项不属于肿瘤细胞异型性的表现？",
        "options": ["核深染、核仁明显", "核分裂象增多且可见病理性核分裂", "细胞大小形态多形性", "大量中性粒细胞渗出形成脓液"],
        "answer": "大量中性粒细胞渗出形成脓液",
        "explanation": "中性粒细胞脓液是炎症特征，不是肿瘤异型性。"
    },
    {
        "question": "【第5章】肿瘤的“分级（grading）”主要依据是？",
        "options": ["组织学分化程度/异型性与核分裂情况", "肿瘤大小与有无转移", "患者年龄与性别", "肿瘤发生部位"],
        "answer": "组织学分化程度/异型性与核分裂情况",
        "explanation": "分级偏组织学恶性度；分期偏临床进展范围。"
    },
    {
        "question": "【第5章】肿瘤的“分期（staging）”最常用的系统是？",
        "options": ["TNM 分期", "ABO 分型", "Gleason 评分用于所有肿瘤", "Reid 指数"],
        "answer": "TNM 分期",
        "explanation": "TNM：原发肿瘤(T)、淋巴结(N)、远处转移(M)。"
    },
    {
        "question": "【第5章】癌（carcinoma）与肉瘤（sarcoma）的最主要区别在于？",
        "options": ["来源组织不同：癌源自上皮，肉瘤源自间叶", "癌一定良性", "肉瘤一定不转移", "二者都只发生于儿童"],
        "answer": "来源组织不同：癌源自上皮，肉瘤源自间叶",
        "explanation": "来源决定命名与部分生物学行为特点。"
    },
    {
        "question": "【第5章】肿瘤命名中，“腺瘤”通常指？",
        "options": ["来源于腺上皮的良性肿瘤", "来源于腺上皮的恶性肿瘤", "来源于间叶组织的良性肿瘤", "来源于淋巴组织的恶性肿瘤"],
        "answer": "来源于腺上皮的良性肿瘤",
        "explanation": "腺癌才是腺上皮来源的恶性肿瘤。"
    },
    {
        "question": "【第5章】肿瘤的主要转移途径不包括？",
        "options": ["淋巴道转移", "血道转移", "种植转移", "肝细胞脂肪变性转移"],
        "answer": "肝细胞脂肪变性转移",
        "explanation": "脂肪变性是变性，不是转移途径。"
    },
    {
        "question": "【第5章】上皮性恶性肿瘤最常见的转移方式是？",
        "options": ["淋巴道转移", "血道转移为主且从不经淋巴", "仅种植转移", "仅局部扩张不转移"],
        "answer": "淋巴道转移",
        "explanation": "癌多经淋巴转移；肉瘤更偏血道转移（但非绝对）。"
    },
    {
        "question": "【第5章】“癌前病变”更恰当的理解是？",
        "options": [
            "某些病变有较高概率发展为癌，但并非必然",
            "已经发生远处转移的癌",
            "任何慢性炎症都等同癌前病变",
            "完全正常的组织状态"
        ],
        "answer": "某些病变有较高概率发展为癌，但并非必然",
        "explanation": "癌前病变强调“风险升高”，如不典型增生等。"
    },
    {
        "question": "【第5章】“原位癌”的关键特征是？",
        "options": ["癌细胞局限于上皮内，未突破基底膜", "癌细胞已进入血流", "已形成广泛淋巴结转移", "一定形成巨大肿块"],
        "answer": "癌细胞局限于上皮内，未突破基底膜",
        "explanation": "是否突破基底膜是原位癌与浸润癌的关键分界。"
    },
    {
        "question": "【第5章】肿瘤对机体影响中，“恶病质”常表现为？",
        "options": ["消瘦、贫血、乏力与代谢紊乱", "皮肤局限性红肿热痛", "持续高血钙导致抽搐", "急性肺水肿必然发生"],
        "answer": "消瘦、贫血、乏力与代谢紊乱",
        "explanation": "肿瘤恶病质与炎症因子、代谢改变、摄入减少等有关。"
    },
    {
        "question": "【第5章】恶性肿瘤更常见的镜下生长边界特点是？",
        "options": ["边界不清，浸润性生长破坏周围组织", "包膜完整且与周围分界清楚", "只压迫不侵入", "只在腔内生长不侵袭"],
        "answer": "边界不清，浸润性生长破坏周围组织",
        "explanation": "浸润性生长是恶性肿瘤的重要形态学特征。"
    },
]

# -------------------------
# 第6章 心血管系统疾病（15）
# -------------------------
quiz_data += [
    {
        "question": "【第6章】动脉粥样硬化最常累及的血管是？",
        "options": ["大中型动脉（如主动脉、冠状动脉）", "毛细血管", "静脉", "淋巴管"],
        "answer": "大中型动脉（如主动脉、冠状动脉）",
        "explanation": "粥样硬化主要发生于大中型动脉内膜。"
    },
    {
        "question": "【第6章】动脉粥样硬化斑块的典型结构包括？",
        "options": ["纤维帽 + 脂质坏死核心", "干酪样坏死 + 朗罕巨细胞", "大量中性粒细胞脓液", "肉芽组织填充的空腔"],
        "answer": "纤维帽 + 脂质坏死核心",
        "explanation": "斑块表面为纤维帽，深部为脂质、坏死碎屑、泡沫细胞等。"
    },
    {
        "question": "【第6章】粥样硬化斑块最危险的并发症之一是？",
        "options": ["斑块破裂/糜烂继发血栓形成", "局部上皮化生", "组织再生完全恢复", "肉芽组织大量出血"],
        "answer": "斑块破裂/糜烂继发血栓形成",
        "explanation": "斑块破裂暴露促凝物质，可致急性血栓导致心梗/脑梗等。"
    },
    {
        "question": "【第6章】冠状动脉粥样硬化性心脏病最严重的类型之一是？",
        "options": ["急性心肌梗死", "慢性胃炎", "矽肺", "慢性肾盂肾炎"],
        "answer": "急性心肌梗死",
        "explanation": "冠脉急性闭塞可致心肌缺血坏死，形成心肌梗死。"
    },
    {
        "question": "【第6章】心肌梗死最常见的坏死类型是？",
        "options": ["凝固性坏死", "液化性坏死", "干酪样坏死", "脂肪坏死"],
        "answer": "凝固性坏死",
        "explanation": "实质器官缺血坏死多为凝固性坏死。"
    },
    {
        "question": "【第6章】心肌梗死后早期（数天内）最危险的并发症之一是？",
        "options": ["心律失常/猝死", "肝硬化", "胃穿孔", "骨折不愈合"],
        "answer": "心律失常/猝死",
        "explanation": "心肌电活动不稳定可导致致命性心律失常。"
    },
    {
        "question": "【第6章】长期高血压最常见的小动脉病变是？",
        "options": ["玻璃样变性小动脉硬化", "干酪样坏死", "脓肿形成", "脂肪坏死"],
        "answer": "玻璃样变性小动脉硬化",
        "explanation": "良性/缓进性高血压常致小动脉玻璃样变性与管腔狭窄。"
    },
    {
        "question": "【第6章】高血压导致心脏最典型的结构性改变是？",
        "options": ["左心室肥厚", "右心室萎缩", "心肌脂肪变性必然发生", "心脏肿瘤形成"],
        "answer": "左心室肥厚",
        "explanation": "长期压力负荷↑→心肌细胞肥大→左室肥厚。"
    },
    {
        "question": "【第6章】风湿病（风湿热）最具特征性的病理改变是？",
        "options": ["Aschoff小体（风湿小体）", "干酪样坏死", "硅结节", "假膜形成"],
        "answer": "Aschoff小体（风湿小体）",
        "explanation": "Aschoff小体是风湿热的特征性改变，常见于心肌间质。"
    },
    {
        "question": "【第6章】风湿性心内膜炎的赘生物典型分布部位是？",
        "options": ["瓣膜闭合缘", "瓣膜游离缘外侧心室面随意处", "心外膜表面", "冠状动脉内膜"],
        "answer": "瓣膜闭合缘",
        "explanation": "风湿性心内膜炎赘生物小而沿闭合缘排列。"
    },
    {
        "question": "【第6章】慢性风湿性心瓣膜病最常累及的瓣膜是？",
        "options": ["二尖瓣", "三尖瓣", "主动脉瓣从不受累", "肺动脉瓣最常受累"],
        "answer": "二尖瓣",
        "explanation": "慢性风湿病最常致二尖瓣狭窄/关闭不全。"
    },
    {
        "question": "【第6章】感染性心内膜炎的赘生物特点更符合？",
        "options": [
            "赘生物大而脆，含大量纤维蛋白与细菌，易脱落形成败血性栓塞",
            "赘生物小且牢固，从不脱落",
            "赘生物只发生于心外膜",
            "赘生物完全由钙盐构成"
        ],
        "answer": "赘生物大而脆，含大量纤维蛋白与细菌，易脱落形成败血性栓塞",
        "explanation": "感染性心内膜炎赘生物易脱落导致栓塞与脓肿。"
    },
    {
        "question": "【第6章】瓣膜病导致的慢性血流动力学后果最常见的是？",
        "options": ["心腔扩大与心力衰竭", "肝硬化结节形成", "矽肺形成", "肾小球新月体形成"],
        "answer": "心腔扩大与心力衰竭",
        "explanation": "狭窄/关闭不全引起压力或容量负荷，最终心衰。"
    },
    {
        "question": "【第6章】动脉粥样硬化导致“血管壁变脆弱”后可出现的并发症是？",
        "options": ["动脉瘤形成", "组织再生加快", "化生增强", "脓肿形成必然发生"],
        "answer": "动脉瘤形成",
        "explanation": "粥样硬化可破坏中膜弹力结构，增加动脉瘤风险。"
    },
    {
        "question": "【第6章】冠状动脉粥样硬化最直接导致心肌缺血的机制是？",
        "options": ["管腔狭窄或急性血栓导致供血不足", "静脉回流增多", "毛细血管增生", "心肌细胞再生过度"],
        "answer": "管腔狭窄或急性血栓导致供血不足",
        "explanation": "狭窄长期缺血；斑块破裂血栓可致急性闭塞。"
    },
]

# -------------------------
# 第7章 呼吸系统疾病（15）
# -------------------------
quiz_data += [
    {
        "question": "【第7章】大叶性肺炎最典型的受累范围是？",
        "options": ["一个肺叶或多个肺叶大部分肺泡弥漫性实变", "仅支气管黏膜表浅炎症", "仅局限于肺尖小灶", "仅胸膜腔积液而肺实质不变"],
        "answer": "一个肺叶或多个肺叶大部分肺泡弥漫性实变",
        "explanation": "大叶性肺炎以肺泡内纤维素性渗出为主，呈“实变”。"
    },
    {
        "question": "【第7章】大叶性肺炎的经典病理分期顺序是？",
        "options": ["充血期→红色肝变期→灰色肝变期→消散期", "坏死期→钙化期→化生期→肿瘤期", "渗出期→结节期→纤维化期→肝硬化期", "增生期→萎缩期→肥大期→化生期"],
        "answer": "充血期→红色肝变期→灰色肝变期→消散期",
        "explanation": "典型分期反映渗出物成分与细胞变化的演进。"
    },
    {
        "question": "【第7章】小叶性肺炎（支气管肺炎）的病变分布特点是？",
        "options": ["多灶性、散在、以细支气管周围肺实质为主", "整叶弥漫性实变", "仅累及肺间质不累及肺泡", "仅累及胸膜不累及肺"],
        "answer": "多灶性、散在、以细支气管周围肺实质为主",
        "explanation": "支气管肺炎常为散在灶性实变，易融合。"
    },
    {
        "question": "【第7章】慢性支气管炎的基本病理改变之一是？",
        "options": ["黏液腺增生、杯状细胞增多（Reid指数增高）", "干酪样坏死", "硅结节形成", "肺泡壁广泛破裂并融合为大泡（必然）"],
        "answer": "黏液腺增生、杯状细胞增多（Reid指数增高）",
        "explanation": "慢性支气管炎与黏液分泌过多、气道慢性炎症相关。"
    },
    {
        "question": "【第7章】支气管哮喘的典型气道炎症细胞特点更符合？",
        "options": ["嗜酸性粒细胞增多", "中性粒细胞为主且脓液形成", "仅巨噬细胞聚集形成肉芽肿", "红细胞为主渗出"],
        "answer": "嗜酸性粒细胞增多",
        "explanation": "哮喘为慢性气道炎症与高反应性，常见嗜酸性粒细胞。"
    },
    {
        "question": "【第7章】肺气肿的定义最准确的是？",
        "options": [
            "终末细支气管远端气腔永久性扩张并伴肺泡壁破坏",
            "肺泡腔内大量纤维蛋白渗出",
            "肺泡内形成干酪样坏死",
            "肺泡内形成大量脓液腔隙"
        ],
        "answer": "终末细支气管远端气腔永久性扩张并伴肺泡壁破坏",
        "explanation": "肺气肿核心是“扩张 + 壁破坏”，弹性回缩下降。"
    },
    {
        "question": "【第7章】支气管扩张症最恰当的描述是？",
        "options": ["支气管不可逆扩张，常与慢性感染/阻塞相关", "支气管短暂痉挛可逆", "肺泡壁破坏导致气腔扩大", "胸膜腔积液导致肺不张"],
        "answer": "支气管不可逆扩张，常与慢性感染/阻塞相关",
        "explanation": "长期感染与阻塞可破坏支气管壁结构，导致不可逆扩张。"
    },
    {
        "question": "【第7章】慢阻肺（COPD）最核心的病理基础通常包括？",
        "options": ["慢性支气管炎与肺气肿（可合并）", "结核性肉芽肿", "肺癌细胞浸润", "肺泡内假膜形成"],
        "answer": "慢性支气管炎与肺气肿（可合并）",
        "explanation": "COPD常由吸烟等导致慢性炎症与气道/肺泡结构破坏。"
    },
    {
        "question": "【第7章】肺心病（cor pulmonale）指的是？",
        "options": ["肺疾病导致肺动脉高压并引起右心肥厚/扩大", "左心衰导致肺淤血", "冠脉狭窄导致心肌梗死", "全身高血压导致左室肥厚"],
        "answer": "肺疾病导致肺动脉高压并引起右心肥厚/扩大",
        "explanation": "慢性肺部疾病→肺血管阻力↑→肺动脉高压→右心负荷↑。"
    },
    {
        "question": "【第7章】矽肺的典型病理改变是？",
        "options": ["硅结节形成并可进展为广泛肺间质纤维化", "干酪样坏死结节为主", "肺泡内大量脓液", "肺泡壁普遍破裂为大泡（单一表现）"],
        "answer": "硅结节形成并可进展为广泛肺间质纤维化",
        "explanation": "吸入二氧化硅→巨噬细胞反应→结节与纤维化，常累及上肺。"
    },
    {
        "question": "【第7章】矽肺常见并发症之一是？",
        "options": ["结核病", "胃溃疡穿孔", "肝硬化", "急性胰腺炎"],
        "answer": "结核病",
        "explanation": "矽肺患者肺防御受损，易并发结核感染。"
    },
    {
        "question": "【第7章】肺癌最重要的危险因素是？",
        "options": ["吸烟", "高盐饮食", "缺乏运动", "低蛋白饮食"],
        "answer": "吸烟",
        "explanation": "吸烟与多种肺癌类型发生风险显著相关。"
    },
    {
        "question": "【第7章】肺癌常见的转移途径不包括？",
        "options": ["淋巴结转移", "血道转移", "胸膜种植", "经胆道逆行转移为主"],
        "answer": "经胆道逆行转移为主",
        "explanation": "肺癌常经淋巴/血道转移，也可胸膜播散；胆道并非主要途径。"
    },
    {
        "question": "【第7章】鼻咽癌在病因学上常与哪种病毒相关？",
        "options": ["EB 病毒（EBV）", "HPV", "HBV", "HIV"],
        "answer": "EB 病毒（EBV）",
        "explanation": "鼻咽癌与EBV感染有较强相关性（尤其某些地区高发）。"
    },
    {
        "question": "【第7章】呼吸窘迫综合征（ARDS）的典型病理表现可见？",
        "options": ["透明膜形成（肺泡壁/管壁）", "干酪样坏死", "硅结节", "心衰细胞大量沉积为主"],
        "answer": "透明膜形成（肺泡壁/管壁）",
        "explanation": "ARDS为弥漫性肺泡损伤，常见透明膜与严重气体交换障碍。"
    },
]

# -------------------------
# 第8章 消化系统疾病（15）
# -------------------------
quiz_data += [
    {
        "question": "【第8章】慢性胃炎常见的主要类型包括？",
        "options": ["浅表性胃炎与萎缩性胃炎", "干酪性胃炎与化脓性胃炎", "硅尘性胃炎与尘肺性胃炎", "梗死性胃炎与栓塞性胃炎"],
        "answer": "浅表性胃炎与萎缩性胃炎",
        "explanation": "临床病理常将慢性胃炎概括为浅表性与萎缩性等类型。"
    },
    {
        "question": "【第8章】萎缩性胃炎的重要病理意义之一是？",
        "options": ["可出现肠上皮化生与不典型增生，增加癌变风险", "必然形成脓肿", "必然引起肺心病", "必然导致肾小球新月体形成"],
        "answer": "可出现肠上皮化生与不典型增生，增加癌变风险",
        "explanation": "萎缩、化生、不典型增生是胃癌发生风险升高的重要背景。"
    },
    {
        "question": "【第8章】消化性溃疡发病机制的核心矛盾可概括为？",
        "options": ["黏膜防御与攻击因素失衡（酸/胃蛋白酶等）", "单纯血栓形成", "单纯肿瘤转移", "单纯钙盐沉积"],
        "answer": "黏膜防御与攻击因素失衡（酸/胃蛋白酶等）",
        "explanation": "攻击因素（胃酸、H. pylori、NSAIDs）与防御屏障失衡是关键。"
    },
    {
        "question": "【第8章】消化性溃疡的大体形态更典型的是？",
        "options": ["圆形/椭圆形、边缘整齐、底部较平滑（“冲孔样”）", "菜花样外生性肿块", "弥漫性整叶实变", "多发硅结节"],
        "answer": "圆形/椭圆形、边缘整齐、底部较平滑（“冲孔样”）",
        "explanation": "典型溃疡边缘整齐，底部可见瘢痕组织与血管改变。"
    },
    {
        "question": "【第8章】消化性溃疡最常见的严重并发症不包括？",
        "options": ["出血", "穿孔", "幽门梗阻", "必然发生肝硬化"],
        "answer": "必然发生肝硬化",
        "explanation": "溃疡常见并发症为出血、穿孔、瘢痕狭窄导致梗阻等。"
    },
    {
        "question": "【第8章】病毒性肝炎的基本病理改变核心是？",
        "options": ["肝细胞变性坏死与炎细胞浸润", "肝细胞脂肪变性必然发生且无炎症", "肝内形成硅结节", "肝内形成大量脓肿为主"],
        "answer": "肝细胞变性坏死与炎细胞浸润",
        "explanation": "肝细胞损伤与炎症反应是病毒性肝炎的基本病理学基础。"
    },
    {
        "question": "【第8章】急性病毒性肝炎更常见的结局是？",
        "options": ["痊愈或完全恢复（多数）", "必然进展为肝硬化", "必然发生肝癌", "必然出现结核结节"],
        "answer": "痊愈或完全恢复（多数）",
        "explanation": "多数急性病毒性肝炎可恢复；少数迁延/慢性化或暴发。"
    },
    {
        "question": "【第8章】慢性肝炎的组织学活动性加重时可见？",
        "options": ["桥接性坏死/纤维隔形成", "硅结节", "肺泡透明膜", "Aschoff小体"],
        "answer": "桥接性坏死/纤维隔形成",
        "explanation": "坏死与纤维化加重可为肝硬化形成奠基。"
    },
    {
        "question": "【第8章】肝硬化的定义核心包括？",
        "options": ["弥漫性肝纤维化 + 再生结节形成 + 正常结构改建", "局灶性化脓", "肝细胞完全液化", "胆管单纯扩张无纤维化"],
        "answer": "弥漫性肝纤维化 + 再生结节形成 + 正常结构改建",
        "explanation": "肝硬化本质是“纤维化+结节+结构重建”。"
    },
    {
        "question": "【第8章】肝硬化导致门脉高压最常见的临床病理后果不包括？",
        "options": ["食管胃底静脉曲张", "脾大", "腹水", "肺泡透明膜形成"],
        "answer": "肺泡透明膜形成",
        "explanation": "门脉高压常致侧支循环形成、脾大、腹水等。"
    },
    {
        "question": "【第8章】食管癌最常见的主要扩散方式之一是？",
        "options": ["淋巴道转移", "仅血道转移且不经淋巴", "仅局部膨胀不浸润", "仅经胆道播散"],
        "answer": "淋巴道转移",
        "explanation": "消化道上皮性恶性肿瘤常较早发生淋巴结转移。"
    },
    {
        "question": "【第8章】胃癌（尤其弥漫型）可导致胃壁弥漫增厚、变硬，称为？",
        "options": ["皮革胃", "槟榔肝", "棕色硬化", "鱼口样狭窄"],
        "answer": "皮革胃",
        "explanation": "弥漫浸润可使胃壁硬化增厚，胃腔缩小，称皮革胃。"
    },
    {
        "question": "【第8章】原发性肝癌（肝细胞癌）常见的侵袭/扩散特点是？",
        "options": ["易侵犯门静脉形成癌栓", "只局限于肝表面不侵袭血管", "只发生淋巴转移不侵袭血管", "只形成良性结节不破坏结构"],
        "answer": "易侵犯门静脉形成癌栓",
        "explanation": "肝细胞癌血管侵犯常见，门静脉癌栓是重要特点。"
    },
    {
        "question": "【第8章】大肠癌较常见的组织学类型是？",
        "options": ["腺癌", "肉瘤", "淋巴瘤一定为主", "黑色素瘤"],
        "answer": "腺癌",
        "explanation": "大肠上皮来源肿瘤以腺癌最常见。"
    },
    {
        "question": "【第8章】消化系统肿瘤的主要远处血道转移器官常见是？",
        "options": ["肝", "甲状腺", "胰腺", "脑膜"],
        "answer": "肝",
        "explanation": "门静脉系统回流使消化道肿瘤易血道转移至肝。"
    },
]

# -------------------------
# 第9章 淋巴造血系统疾病（15）
# -------------------------
quiz_data += [
    {
        "question": "【第9章】淋巴样肿瘤（淋巴瘤）的基本概念是？",
        "options": ["淋巴组织/淋巴细胞来源的恶性肿瘤", "任何淋巴结肿大", "急性炎症性肿胀", "良性增生性结节一定不会恶变"],
        "answer": "淋巴组织/淋巴细胞来源的恶性肿瘤",
        "explanation": "淋巴瘤属于造血/淋巴系统恶性肿瘤。"
    },
    {
        "question": "【第9章】霍奇金淋巴瘤的诊断关键之一是发现？",
        "options": ["Reed–Sternberg（R-S）细胞", "大量中性粒细胞脓液", "干酪样坏死必然存在", "硅结节"],
        "answer": "Reed–Sternberg（R-S）细胞",
        "explanation": "R-S细胞是霍奇金淋巴瘤的重要形态学依据。"
    },
    {
        "question": "【第9章】霍奇金淋巴瘤的扩散方式更常表现为？",
        "options": ["沿相邻淋巴结连续扩散", "早期即广泛跳跃性播散为主", "只血道转移不累及淋巴结", "只局限于原发部位永不扩散"],
        "answer": "沿相邻淋巴结连续扩散",
        "explanation": "霍奇金淋巴瘤常呈连续性扩散特点。"
    },
    {
        "question": "【第9章】非霍奇金淋巴瘤更常见的特点是？",
        "options": ["跳跃性扩散并可早期累及结外组织", "一定只局限于单个淋巴结", "一定出现R-S细胞", "一定为良性"],
        "answer": "跳跃性扩散并可早期累及结外组织",
        "explanation": "非霍奇金淋巴瘤常见结外侵犯与不连续扩散。"
    },
    {
        "question": "【第9章】淋巴瘤患者最常见的临床表现之一是？",
        "options": ["无痛性进行性淋巴结肿大", "剧烈咳脓痰", "突发右下腹绞痛", "反复黑便为唯一表现"],
        "answer": "无痛性进行性淋巴结肿大",
        "explanation": "无痛性淋巴结肿大是淋巴瘤常见首发表现。"
    },
    {
        "question": "【第9章】B细胞淋巴瘤中，Burkitt淋巴瘤的典型形态学描述常为？",
        "options": ["“星空样”外观", "“皮革胃”外观", "“槟榔肝”外观", "“棕色硬化”外观"],
        "answer": "“星空样”外观",
        "explanation": "Burkitt常见高增殖伴吞噬细胞形成“星空样”外观。"
    },
    {
        "question": "【第9章】黏膜相关淋巴组织（MALT）淋巴瘤常与哪类慢性刺激相关？",
        "options": ["慢性炎症/感染（如慢性胃炎相关）", "单纯缺血梗死", "矽尘吸入", "急性化脓性感染一次即可"],
        "answer": "慢性炎症/感染（如慢性胃炎相关）",
        "explanation": "MALT淋巴瘤常发生在长期抗原刺激背景下。"
    },
    {
        "question": "【第9章】淋巴瘤侵犯骨髓后最可能导致？",
        "options": ["外周血细胞减少（贫血/感染倾向/出血倾向）", "必然形成肺泡透明膜", "必然出现槟榔肝", "必然发生胰腺脂肪坏死"],
        "answer": "外周血细胞减少（贫血/感染倾向/出血倾向）",
        "explanation": "骨髓受侵会影响造血，出现贫血、白细胞/血小板减少等。"
    },
    {
        "question": "【第9章】淋巴样肿瘤的“分期”临床意义主要体现在？",
        "options": ["指导治疗方案与判断预后", "用于判断血钙水平", "用于确定是否为炎症", "用于鉴别凝固性坏死"],
        "answer": "指导治疗方案与判断预后",
        "explanation": "分期反映疾病范围，是治疗与预后评估的重要依据。"
    },
    {
        "question": "【第9章】淋巴结被淋巴瘤累及的常见病理学改变是？",
        "options": ["正常结构被肿瘤细胞弥漫/结节性取代（结构破坏）", "仅见血栓形成而结构完整", "仅见钙化而无细胞增生", "仅见脂肪变性而无肿瘤细胞"],
        "answer": "正常结构被肿瘤细胞弥漫/结节性取代（结构破坏）",
        "explanation": "淋巴瘤可破坏淋巴结正常滤泡/窦结构。"
    },
    {
        "question": "【第9章】霍奇金淋巴瘤常见的全身症状（B症状）不包括？",
        "options": ["发热", "盗汗", "体重下降", "持续大量咳脓痰为典型"],
        "answer": "持续大量咳脓痰为典型",
        "explanation": "B症状通常指不明原因发热、盗汗、体重下降。"
    },
    {
        "question": "【第9章】淋巴样肿瘤与炎性反应性淋巴结肿大的重要鉴别点之一是？",
        "options": ["是否存在单克隆性肿瘤性增殖", "是否出现局部红肿热痛", "是否有咳嗽", "是否伴腹泻"],
        "answer": "是否存在单克隆性肿瘤性增殖",
        "explanation": "反应性增生多为多克隆；淋巴瘤多为单克隆增殖。"
    },
    {
        "question": "【第9章】淋巴造血系统肿瘤常见的器官累及不包括？",
        "options": ["脾", "肝", "骨髓", "胰腺外分泌腺泡为首选部位"],
        "answer": "胰腺外分泌腺泡为首选部位",
        "explanation": "淋巴瘤常累及淋巴结、脾、肝、骨髓等，胰腺并非首选。"
    },
    {
        "question": "【第9章】淋巴瘤“结外侵犯”更常见于？",
        "options": ["非霍奇金淋巴瘤", "霍奇金淋巴瘤", "良性淋巴结反应性增生", "单纯急性炎症"],
        "answer": "非霍奇金淋巴瘤",
        "explanation": "非霍奇金淋巴瘤更易出现结外组织侵犯。"
    },
    {
        "question": "【第9章】淋巴样肿瘤的病因学中，下列哪项更常被认为与部分淋巴瘤相关？",
        "options": ["病毒感染/免疫异常/慢性抗原刺激", "单纯骨折", "短期轻度缺氧", "一次性轻微外伤"],
        "answer": "病毒感染/免疫异常/慢性抗原刺激",
        "explanation": "部分淋巴瘤与EBV等感染、免疫缺陷、慢性炎症刺激有关。"
    },
]

# -------------------------
# 第10章 泌尿系统疾病（15）
# -------------------------
quiz_data += [
    {
        "question": "【第10章】肾炎综合征（nephritic syndrome）的典型表现不包括？",
        "options": ["血尿", "少尿", "高血压", "大量蛋白尿导致明显水肿为唯一表现"],
        "answer": "大量蛋白尿导致明显水肿为唯一表现",
        "explanation": "肾炎综合征以血尿、少尿、高血压、轻中度蛋白尿等为主；大量蛋白尿更偏肾病综合征。"
    },
    {
        "question": "【第10章】肾病综合征（nephrotic syndrome）的核心指标是？",
        "options": ["大量蛋白尿", "咯血", "黄疸", "腹膜刺激征"],
        "answer": "大量蛋白尿",
        "explanation": "肾病综合征常见大量蛋白尿、低白蛋白血症、水肿、高脂血症。"
    },
    {
        "question": "【第10章】急性链球菌感染后肾小球肾炎最典型的病理特点是？",
        "options": ["肾小球弥漫性细胞增多（增生性改变）", "干酪样坏死结节", "硅结节形成", "透明膜形成"],
        "answer": "肾小球弥漫性细胞增多（增生性改变）",
        "explanation": "免疫复合物相关损伤可致肾小球细胞增生与炎症反应。"
    },
    {
        "question": "【第10章】快速进行性肾小球肾炎（RPGN）更具特征性的形态学改变是？",
        "options": ["新月体形成", "大量脓肿形成", "广泛脂肪坏死", "粥样斑块形成"],
        "answer": "新月体形成",
        "explanation": "新月体反映严重肾小球损伤与增生反应，进展快、预后差。"
    },
    {
        "question": "【第10章】微小病变性肾病（常见于儿童肾病综合征）的关键改变更偏向？",
        "options": ["足突融合（电镜）", "肾小球干酪样坏死", "大量中性粒细胞脓肿", "硅结节"],
        "answer": "足突融合（电镜）",
        "explanation": "光镜常不明显，电镜见足突融合是典型特征。"
    },
    {
        "question": "【第10章】膜性肾病更常见的形态学特点是？",
        "options": ["肾小球毛细血管壁弥漫性增厚", "肾小球弥漫性出血性坏死", "肾小球形成大量肉芽肿", "肾小球完全液化"],
        "answer": "肾小球毛细血管壁弥漫性增厚",
        "explanation": "膜性肾病以基底膜相关沉积导致“壁增厚”为突出表现。"
    },
    {
        "question": "【第10章】急性肾盂肾炎的病理学本质更符合？",
        "options": ["肾间质与肾小管的化脓性炎症", "肾小球原发性肿瘤", "肾皮质干酪样坏死", "肾小动脉粥样硬化为主"],
        "answer": "肾间质与肾小管的化脓性炎症",
        "explanation": "多由细菌上行感染引起，表现为化脓性炎症与脓性渗出。"
    },
    {
        "question": "【第10章】慢性肾盂肾炎更典型的形态学特点之一是？",
        "options": ["肾盂肾盏变形、瘢痕收缩，肾小管“甲状腺样变”", "整肾弥漫性实变", "硅结节广泛分布", "透明膜弥漫形成"],
        "answer": "肾盂肾盏变形、瘢痕收缩，肾小管“甲状腺样变”",
        "explanation": "慢性反复感染/反流可致瘢痕与肾小管扩张内含胶样物。"
    },
    {
        "question": "【第10章】肾细胞癌最常见的组织学类型是？",
        "options": ["透明细胞型", "鳞状细胞癌", "小细胞癌", "基底细胞癌"],
        "answer": "透明细胞型",
        "explanation": "透明细胞肾癌来源肾小管上皮，细胞质富脂/糖原显透明。"
    },
    {
        "question": "【第10章】肾细胞癌的大体特点更常见的是？",
        "options": ["肿块常呈黄染，易出血坏死", "整肾呈槟榔样", "全肾干酪样坏死", "形成大量脓腔为主"],
        "answer": "肿块常呈黄染，易出血坏死",
        "explanation": "透明细胞肾癌常呈黄色（脂质）并可伴出血坏死。"
    },
    {
        "question": "【第10章】肾细胞癌较有特征性的转移途径是？",
        "options": ["侵入肾静脉/下腔静脉并血道转移", "仅沿淋巴结连续扩散且不入静脉", "仅种植到腹膜表面", "只局部膨胀无转移"],
        "answer": "侵入肾静脉/下腔静脉并血道转移",
        "explanation": "肾癌可形成静脉癌栓并远处转移（如肺、骨）。"
    },
    {
        "question": "【第10章】膀胱癌最常见的组织学类型是？",
        "options": ["尿路上皮癌（移行细胞癌）", "腺癌", "鳞癌一定为主", "肝细胞癌转移"],
        "answer": "尿路上皮癌（移行细胞癌）",
        "explanation": "膀胱内衬为尿路上皮，相关肿瘤以尿路上皮癌最常见。"
    },
    {
        "question": "【第10章】膀胱尿路上皮癌的重要危险因素之一是？",
        "options": ["吸烟/芳香胺类化学物暴露", "高盐饮食", "缺乏维生素C", "短期轻微感冒"],
        "answer": "吸烟/芳香胺类化学物暴露",
        "explanation": "吸烟与化工染料（芳香胺）暴露均可增加膀胱癌风险。"
    },
    {
        "question": "【第10章】各型肾小球肾炎的临床病理联系中，“蛋白尿”最直接反映的是？",
        "options": ["滤过屏障受损（毛细血管壁/足细胞功能异常）", "肾盂积脓", "输尿管结石", "膀胱肌层肥厚"],
        "answer": "滤过屏障受损（毛细血管壁/足细胞功能异常）",
        "explanation": "滤过屏障损伤会导致血浆蛋白漏出进入尿液。"
    },
    {
        "question": "【第10章】急性肾盂肾炎的典型尿沉渣线索更符合？",
        "options": ["白细胞管型/脓尿", "大量胆红素结晶", "大量脂滴与泡沫细胞", "大量肿瘤细胞一定出现"],
        "answer": "白细胞管型/脓尿",
        "explanation": "肾小管内白细胞与炎症渗出可形成白细胞管型。"
    },
]

# -------------------------
# 第11章 生殖系统和乳腺疾病（15）
# -------------------------
quiz_data += [
    {
        "question": "【第11章】子宫颈上皮内瘤变（CIN）的本质更接近于？",
        "options": ["癌前病变（不典型增生谱系）", "良性肿瘤必不恶变", "急性化脓性炎症", "干酪样坏死结节"],
        "answer": "癌前病变（不典型增生谱系）",
        "explanation": "CIN属于宫颈癌前病变，程度与累及上皮厚度相关。"
    },
    {
        "question": "【第11章】宫颈癌最常见的组织学类型是？",
        "options": ["鳞状细胞癌", "肝细胞癌", "透明细胞癌", "骨肉瘤"],
        "answer": "鳞状细胞癌",
        "explanation": "宫颈鳞柱交界区易发生鳞癌相关病变。"
    },
    {
        "question": "【第11章】与宫颈癌发生关系最密切的病毒感染是？",
        "options": ["高危型 HPV 感染", "EBV", "HBV", "流感病毒"],
        "answer": "高危型 HPV 感染",
        "explanation": "高危型HPV持续感染是宫颈癌的重要病因学因素。"
    },
    {
        "question": "【第11章】宫颈癌由原位癌发展为浸润癌的关键分界是？",
        "options": ["是否突破基底膜", "肿瘤是否变硬", "是否出现发热", "是否伴咳嗽"],
        "answer": "是否突破基底膜",
        "explanation": "突破基底膜提示浸润性生长，可发生转移。"
    },
    {
        "question": "【第11章】子宫内膜癌（宫体癌）中，与雌激素过多相关的一型更常见背景是？",
        "options": ["子宫内膜增生/无排卵等高雌激素状态", "矽尘吸入", "结核感染", "长期低血压"],
        "answer": "子宫内膜增生/无排卵等高雌激素状态",
        "explanation": "雌激素刺激与内膜增生可增加Ⅰ型内膜癌风险。"
    },
    {
        "question": "【第11章】滋养层肿瘤中，葡萄胎最典型的肉眼表现是？",
        "options": ["绒毛水肿呈“葡萄串样”", "子宫颈形成假膜", "卵巢形成硅结节", "乳腺呈皮革样硬化"],
        "answer": "绒毛水肿呈“葡萄串样”",
        "explanation": "葡萄胎为绒毛水肿与滋养层增生的病变。"
    },
    {
        "question": "【第11章】绒毛膜癌（绒癌）最重要的生物学行为特点之一是？",
        "options": ["早期血道转移（如肺）", "一定形成包膜且不转移", "只局部压迫不侵袭", "只发生于宫颈上皮表层"],
        "answer": "早期血道转移（如肺）",
        "explanation": "绒癌高度恶性、易血行转移，且可无绒毛结构。"
    },
    {
        "question": "【第11章】乳腺癌最常见的浸润性类型是？",
        "options": ["浸润性导管癌", "浸润性鳞癌", "骨肉瘤", "黑色素瘤"],
        "answer": "浸润性导管癌",
        "explanation": "浸润性导管癌是最常见乳腺恶性肿瘤类型。"
    },
    {
        "question": "【第11章】乳腺癌最常见的淋巴转移途径是？",
        "options": ["腋窝淋巴结", "腹股沟淋巴结为首站", "纵隔淋巴结为唯一", "不经淋巴仅血转移"],
        "answer": "腋窝淋巴结",
        "explanation": "乳腺淋巴回流主要至腋窝淋巴结，是临床分期重要依据。"
    },
    {
        "question": "【第11章】乳腺导管原位癌（DCIS）的关键特征是？",
        "options": ["肿瘤细胞局限于导管系统内，未突破基底膜", "必然形成远处转移", "必然出现干酪样坏死", "只发生在男性且罕见于女性"],
        "answer": "肿瘤细胞局限于导管系统内，未突破基底膜",
        "explanation": "原位癌的关键是未突破基底膜。"
    },
    {
        "question": "【第11章】乳腺小叶原位癌（LCIS）的一个重要临床意义是？",
        "options": ["提示双侧乳腺癌风险升高", "一定形成巨大肿块", "只局限于单侧且不影响风险", "必然转为化脓性炎"],
        "answer": "提示双侧乳腺癌风险升高",
        "explanation": "LCIS更像风险标志，提示双侧后续浸润癌风险增加。"
    },
    {
        "question": "【第11章】乳腺Paget病（乳头湿疹样癌）通常提示？",
        "options": ["乳腺导管系统内常合并癌变", "单纯过敏性皮炎无其他意义", "一定是良性病变", "与矽尘暴露强相关"],
        "answer": "乳腺导管系统内常合并癌变",
        "explanation": "Paget病常与导管原位癌或浸润癌相关。"
    },
    {
        "question": "【第11章】乳腺纤维腺瘤的更恰当表述是？",
        "options": ["常见良性肿瘤，界清，可活动", "高度恶性，早期血转移", "必然发生皮革胃", "典型为干酪样坏死"],
        "answer": "常见良性肿瘤，界清，可活动",
        "explanation": "纤维腺瘤多见于年轻女性，通常为良性、边界清楚。"
    },
    {
        "question": "【第11章】乳腺癌的分子/受体状态中，与内分泌治疗相关的是？",
        "options": ["ER/PR（雌激素/孕激素受体）", "Na⁺/K⁺-ATP酶", "组胺受体", "凝血因子VIII"],
        "answer": "ER/PR（雌激素/孕激素受体）",
        "explanation": "ER/PR阳性提示可能从内分泌治疗获益。"
    },
    {
        "question": "【第11章】宫颈腺癌与鳞癌相比，一个更重要的相关部位是？",
        "options": ["宫颈管腺体/鳞柱交界附近腺体成分", "肺泡壁", "肝小叶中央静脉区", "肾小管集合管"],
        "answer": "宫颈管腺体/鳞柱交界附近腺体成分",
        "explanation": "宫颈腺癌来源腺上皮，常与鳞柱交界区相关。"
    },
]

# -------------------------
# 第12章 结核病（含肠伤寒、细菌性痢疾）（15）
# -------------------------
quiz_data += [
    {
        "question": "【第12章】结核病最基本的病变类型是？",
        "options": ["结核性肉芽肿伴干酪样坏死", "化脓性炎形成脓肿为主", "纤维素性炎形成假膜为主", "脂肪变性为主"],
        "answer": "结核性肉芽肿伴干酪样坏死",
        "explanation": "结核典型为免疫性肉芽肿与干酪样坏死。"
    },
    {
        "question": "【第12章】结核结节中最典型的细胞组合是？",
        "options": ["上皮样细胞、郎罕巨细胞及淋巴细胞", "中性粒细胞为主", "嗜酸性粒细胞为主", "红细胞为主"],
        "answer": "上皮样细胞、郎罕巨细胞及淋巴细胞",
        "explanation": "结核结节属于免疫性肉芽肿，细胞成分具有特征性。"
    },
    {
        "question": "【第12章】原发性肺结核的典型组成是？",
        "options": ["原发灶 + 肺门淋巴结结核 + 淋巴管炎（原发综合征）", "肺尖空洞为主", "仅胸膜腔积液", "仅形成硅结节"],
        "answer": "原发灶 + 肺门淋巴结结核 + 淋巴管炎（原发综合征）",
        "explanation": "原发综合征（Ghon复合体相关）是原发肺结核典型表现。"
    },
    {
        "question": "【第12章】继发性（再感染）肺结核更常见的好发部位是？",
        "options": ["肺尖（上叶尖后段）", "肺下叶基底段为首选", "支气管黏膜表面为唯一", "胸膜腔内为首发"],
        "answer": "肺尖（上叶尖后段）",
        "explanation": "继发性肺结核常在通气良好、氧分压较高的肺尖部位发生。"
    },
    {
        "question": "【第12章】继发性肺结核常见的重要形态学特点之一是？",
        "options": ["空洞形成（干酪坏死液化排出）", "整叶实变并分四期演变", "大量脓肿为唯一表现", "肺泡透明膜为主"],
        "answer": "空洞形成（干酪坏死液化排出）",
        "explanation": "继发结核可发生干酪坏死液化、排出后形成空洞。"
    },
    {
        "question": "【第12章】粟粒性结核（miliary TB）本质上提示？",
        "options": ["结核杆菌经血行播散形成多器官粟粒样病灶", "局部支气管感染不播散", "单纯免疫反应无病原", "仅局限于肠道黏膜"],
        "answer": "结核杆菌经血行播散形成多器官粟粒样病灶",
        "explanation": "血行播散可累及肺、肝、脾、骨髓等多器官。"
    },
    {
        "question": "【第12章】结核病“转化规律”中，较倾向于愈合修复的改变是？",
        "options": ["纤维化与钙化", "大量化脓形成脓肿", "必然发生肿瘤转移", "必然发生脂肪坏死"],
        "answer": "纤维化与钙化",
        "explanation": "结核灶可被纤维包裹并钙化，提示愈合或稳定。"
    },
    {
        "question": "【第12章】肠伤寒的典型病变部位更常在？",
        "options": ["回肠末端Peyer集合淋巴小结", "胃体黏膜为主", "乙状结肠为主", "食管下段为主"],
        "answer": "回肠末端Peyer集合淋巴小结",
        "explanation": "伤寒杆菌易累及回肠集合淋巴组织，出现肿胀坏死溃疡。"
    },
    {
        "question": "【第12章】肠伤寒溃疡的形态特征更典型的是？",
        "options": ["沿肠长轴方向的椭圆形/纵行溃疡", "沿肠横轴的横行溃疡为主", "假膜覆盖为主且浅表", "多发息肉样隆起为主"],
        "answer": "沿肠长轴方向的椭圆形/纵行溃疡",
        "explanation": "伤寒溃疡与Peyer斑走向相关，常呈纵行。"
    },
    {
        "question": "【第12章】肠伤寒最严重的并发症之一是？",
        "options": ["肠出血或肠穿孔", "肺心病", "心肌梗死必然发生", "急性胰腺炎必然发生"],
        "answer": "肠出血或肠穿孔",
        "explanation": "溃疡侵蚀血管可出血，穿透肠壁可致穿孔与腹膜炎。"
    },
    {
        "question": "【第12章】细菌性痢疾更典型的累及部位是？",
        "options": ["结肠（尤其乙状结肠、直肠）", "回肠末端Peyer斑为主", "胃体黏膜为主", "胆囊为主"],
        "answer": "结肠（尤其乙状结肠、直肠）",
        "explanation": "菌痢多累及结肠黏膜，表现为急性炎症与溃疡。"
    },
    {
        "question": "【第12章】细菌性痢疾的典型炎症性质更符合？",
        "options": ["急性化脓性（纤维素性）炎，可形成假膜样渗出", "干酪样肉芽肿性炎为主", "慢性肉芽肿性炎为唯一", "脂肪坏死为主"],
        "answer": "急性化脓性（纤维素性）炎，可形成假膜样渗出",
        "explanation": "菌痢可见黏膜表浅坏死与渗出，形成假膜样改变。"
    },
    {
        "question": "【第12章】鉴别伤寒与菌痢溃疡形态时，较正确的是？",
        "options": ["伤寒多纵行溃疡；菌痢多表浅不规则溃疡/糜烂", "两者溃疡形态完全一致", "菌痢多纵行溃疡；伤寒多假膜", "二者都只发生于胃部"],
        "answer": "伤寒多纵行溃疡；菌痢多表浅不规则溃疡/糜烂",
        "explanation": "伤寒与集合淋巴组织相关；菌痢以结肠黏膜急性炎症坏死为主。"
    },
    {
        "question": "【第12章】结核病的传播途径最常见的是？",
        "options": ["呼吸道飞沫传播", "蚊虫叮咬传播为主", "经皮肤接触为主", "经母婴遗传为主"],
        "answer": "呼吸道飞沫传播",
        "explanation": "肺结核最常通过含菌飞沫吸入传播。"
    },
    {
        "question": "【第12章】伤寒与菌痢共同的重要传播方式是？",
        "options": ["粪-口途径（污染水/食物）", "呼吸道飞沫为主", "血液传播为主", "性传播为主"],
        "answer": "粪-口途径（污染水/食物）",
        "explanation": "两者均可通过污染食物/水导致肠道感染。"
    },
]

import re
import streamlit as st

# =========================
# 你必须确保：quiz_data 在本段代码之前已经定义好
# quiz_data = [ {question, options, answer, explanation, (可选)chapter}, ... ]
# =========================

import streamlit as st
import json
import re
from pathlib import Path

# =========================
# 读取 JSON 题库
# =========================
def load_quiz_json(path: str):
    p = Path(path)
    if not p.exists():
        return []
    return json.loads(p.read_text(encoding="utf-8"))

# 你的原题库：quiz_data（你已经在上面定义好了）
quiz_data_outline = quiz_data

# 新增：PDF 全题库（含主观题）
quiz_data_pdf_all = load_quiz_json("data/quiz_pdf_all.json")

BANKS = {
    "大纲题库": quiz_data_outline,
    "PDF全题库（含主观题）": quiz_data_pdf_all,
}

PLACEHOLDER = "请选择一个选项…"

# =========================
# 工具：章节识别（兼容 int / str / 从题干解析）
# =========================
def get_chapter(item: dict):
    # 优先使用字段
    ch = item.get("chapter")
    if ch is not None and str(ch).strip() != "":
        return ch

    # 兜底：从题干前缀解析 【第X章】
    q = item.get("question", "")
    m = re.search(r"【\s*第\s*(\d+)\s*章\s*】", q)
    if m:
        return int(m.group(1))
    return "未分章"

def build_chapter_options(data):
    # 保持“出现顺序”，同时把数字章节排在前面
    seen = {}
    order = []
    for i, it in enumerate(data):
        ch = get_chapter(it)
        if ch not in seen:
            seen[ch] = len(order)
            order.append(ch)

    numeric = sorted([c for c in order if isinstance(c, int)])
    others = [c for c in order if not isinstance(c, int)]

    # 用“字符串 label”做下拉，避免你截图里出现的空白显示问题
    labels = ["全部"]
    label_to_key = {"全部": None}

    for c in numeric:
        lab = f"第{c}章"
        labels.append(lab)
        label_to_key[lab] = c

    for c in others:
        lab = str(c)
        labels.append(lab)
        label_to_key[lab] = c

    return labels, label_to_key

# =========================
# 工具：主观题粗略判定（更宽松一些）
# =========================
def normalize_text(s: str) -> str:
    s = (s or "").strip()
    s = re.sub(r"\s+", "", s)
    s = s.replace("；", ";").replace("，", ",").replace("。", "").replace("、", ",")
    s = s.replace("（", "(").replace("）", ")")
    return s

def grade_subjective(user: str, answer: str):
    # 没有标准答案就不判分
    if not answer or "暂无" in answer:
        return None

    u = normalize_text(user)
    a = normalize_text(answer)
    if not u:
        return False

    # 完全一致
    if u == a:
        return True

    # 关键词覆盖（把答案按分隔符拆开，80% 出现在用户输入里判正确）
    parts = [p.strip() for p in re.split(r"[;,\s]+", answer) if p.strip()]
    parts = [p for p in parts if len(p) >= 2 and "暂无" not in p]
    if parts:
        hit = sum(1 for p in parts if normalize_text(p) and normalize_text(p) in u)
        if hit / len(parts) >= 0.8:
            return True

    return False

# =========================
# Streamlit 单页应用
# =========================
st.set_page_config(page_title="病理学刷题（单页）", layout="centered")
st.title("🩺 病理学单页刷题 Web App（题库/章节筛选）")

# session_state 基础字段（必须）
if "current_index" not in st.session_state:
    st.session_state.current_index = 0
if "score" not in st.session_state:
    st.session_state.score = 0
if "submitted" not in st.session_state:
    st.session_state.submitted = False
if "last_is_correct" not in st.session_state:
    st.session_state.last_is_correct = None

# 为“不同题库+不同章节”保存独立进度
if "progress_map" not in st.session_state:
    st.session_state.progress_map = {}
if "active_state_key" not in st.session_state:
    st.session_state.active_state_key = None

# ---- 侧边栏：题库选择
st.sidebar.header("📚 题库选择")
bank_name = st.sidebar.selectbox("选择题库", list(BANKS.keys()), key="bank_sel")
active_quiz = BANKS[bank_name]

# 给题目一个“兜底题型”，避免没有 qtype 的题筛选不到
def resolve_qtype(item: dict) -> str:
    qt = item.get("qtype")
    if qt:
        return qt
    return "单选题" if item.get("options") else "简答题"

# ---- 侧边栏：课程筛选（如果题库里没 course 字段，也能用）
st.sidebar.header("📚 课程筛选")
courses = sorted({q.get("course", "未分类") for q in active_quiz})
selected_course = st.sidebar.selectbox("选择课程", ["全部"] + courses, key="course_sel")

# 先按课程过滤一遍，用于生成章节下拉
quiz_after_course = [
    q for q in active_quiz
    if selected_course == "全部" or q.get("course", "未分类") == selected_course
]

# ---- 侧边栏：章节筛选（沿用你原来的 build_chapter_options / get_chapter）
st.sidebar.header("📚 章节筛选")
labels, label_to_key = build_chapter_options(quiz_after_course)
chosen_label = st.sidebar.selectbox("选择章节", labels, key="chapter_sel")
chosen_chapter = label_to_key[chosen_label]

# 再按课程+章节过滤，用于生成题型下拉
quiz_after_chapter = [
    q for q in quiz_after_course
    if chosen_chapter is None or get_chapter(q) == chosen_chapter
]

# ---- 侧边栏：题型筛选
st.sidebar.header("🧩 题型筛选")
qtypes = sorted({resolve_qtype(q) for q in quiz_after_chapter})
selected_qtype = st.sidebar.selectbox("选择题型", ["全部"] + qtypes, key="qtype_sel")

# 构建当前筛选后的题目索引列表（索引仍然基于 active_quiz）
filtered_indices = []
for idx, it in enumerate(active_quiz):
    if selected_course != "全部" and it.get("course", "未分类") != selected_course:
        continue
    if chosen_chapter is not None and get_chapter(it) != chosen_chapter:
        continue
    if selected_qtype != "全部" and resolve_qtype(it) != selected_qtype:
        continue
    filtered_indices.append(idx)

total = len(filtered_indices)

# 当前“题库+课程+章节+题型”的状态 key（用于保存进度）
state_key = f"{bank_name}::{selected_course}::{str(chosen_chapter)}::{selected_qtype}"




def save_current_state():
    st.session_state.progress_map[state_key] = {
        "current_index": st.session_state.current_index,
        "score": st.session_state.score,
        "submitted": st.session_state.submitted,
        "last_is_correct": st.session_state.last_is_correct,
    }

def load_state_for_key():
    data = st.session_state.progress_map.get(state_key, None)
    if data is None:
        st.session_state.current_index = 0
        st.session_state.score = 0
        st.session_state.submitted = False
        st.session_state.last_is_correct = None
    else:
        st.session_state.current_index = data.get("current_index", 0)
        st.session_state.score = data.get("score", 0)
        st.session_state.submitted = data.get("submitted", False)
        st.session_state.last_is_correct = data.get("last_is_correct", None)

# 如果切换了题库/章节，先保存旧状态，再加载新状态
if st.session_state.active_state_key != state_key:
    if st.session_state.active_state_key is not None:
        # 保存旧key的状态
        old_key = st.session_state.active_state_key
        st.session_state.progress_map[old_key] = {
            "current_index": st.session_state.current_index,
            "score": st.session_state.score,
            "submitted": st.session_state.submitted,
            "last_is_correct": st.session_state.last_is_correct,
        }
    load_state_for_key()
    st.session_state.active_state_key = state_key

# 侧边栏显示信息 & 重置按钮
st.sidebar.markdown("---")
st.sidebar.write(f"当前章节题量：**{total}**")
st.sidebar.write(f"当前得分：**{st.session_state.score}**")
st.sidebar.write(f"当前进度：**{min(st.session_state.current_index, total)}/{total}**")

if st.sidebar.button("🔄 重置本题库/章节进度"):
    st.session_state.progress_map[state_key] = {
        "current_index": 0, "score": 0, "submitted": False, "last_is_correct": None
    }
    load_state_for_key()
    st.session_state.active_state_key = state_key
    st.rerun()

# 如果本章节没题
if total == 0:
    st.warning("该筛选条件下暂无题目。请在左侧切换题库/章节。")
    st.stop()

# 进度条
progress = st.session_state.current_index / total if total else 0
st.progress(progress)

# 结算页
if st.session_state.current_index >= total:
    st.success(f"✅ 本章节已完成！总分：{st.session_state.score} / {total}")
    st.progress(1.0)
    if st.button("🔄 重新开始（本章节）", type="primary"):
        st.session_state.current_index = 0
        st.session_state.score = 0
        st.session_state.submitted = False
        st.session_state.last_is_correct = None
        save_current_state()
        st.rerun()
    st.stop()

# 当前题
pos = st.session_state.current_index
global_idx = filtered_indices[pos]
q = active_quiz[global_idx]

qtype = resolve_qtype(q)  # 用上面侧边栏里定义的 resolve_qtype

st.subheader(f"第 {pos+1} / {total} 题")
st.caption(f"题型：{qtype}")
st.write(q["question"])

# 为每道题生成独立 widget key，避免 selected_option 修改报错
widget_key = f"ans::{bank_name}::{global_idx}"
disabled = bool(st.session_state.submitted)

user_answer = None

if qtype == "单选题":
    options = [PLACEHOLDER] + (q.get("options") or [])
    if widget_key not in st.session_state:
        st.session_state[widget_key] = PLACEHOLDER

    user_answer = st.radio(
        "请选择一个选项：",
        options=options,
        index=options.index(st.session_state[widget_key]) if st.session_state[widget_key] in options else 0,
        key=widget_key,
        disabled=disabled,
    )

elif qtype == "多选题":
    options = q.get("options") or []
    if widget_key not in st.session_state:
        st.session_state[widget_key] = []  # 多选默认空列表

    user_answer = st.multiselect(
        "请选择一个或多个选项：",
        options=options,
        key=widget_key,
        disabled=disabled,
    )

else:
    # 主观题
    if widget_key not in st.session_state:
        st.session_state[widget_key] = ""

    if qtype in ("填空题", "名词解释"):
        user_answer = st.text_input("请输入你的答案：", key=widget_key, disabled=disabled)
    else:
        user_answer = st.text_area("请输入你的答案：", key=widget_key, height=120, disabled=disabled)

# 提交按钮
if not st.session_state.submitted:
    if st.button("✅ 提交答案", type="primary"):
        correct = None

        # 判分
if qtype == "单选题":
    if user_answer == PLACEHOLDER:
        st.warning("请先选择一个选项再提交。")
        st.stop()

    if not q.get("answer"):
        correct = None
    else:
        correct = (user_answer == q["answer"])

elif qtype == "多选题":
    # user_answer 是 list[str]
    if not user_answer:
        st.warning("请至少选择一个选项再提交。")
        st.stop()

    ans = q.get("answer")
    # 题库里建议 answer 为 list[str]（正确选项“文本”列表）
    if isinstance(ans, list):
        correct = (set(user_answer) == set(ans))
    else:
        # 如果 answer 是字符串，尝试按分隔符拆成列表（兜底）
        if isinstance(ans, str) and ans.strip():
            parts = [p.strip() for p in re.split(r"[;,，、\s]+", ans) if p.strip()]
            correct = (set(user_answer) == set(parts))
        else:
            correct = None

else:
    correct = grade_subjective(user_answer, q.get("answer", ""))

st.session_state.submitted = True
st.session_state.last_is_correct = correct

if correct is True:
    st.session_state.score += 1

save_current_state()
st.rerun()

# 提交后反馈 + 解析 + 下一题
if st.session_state.submitted:
    correct = st.session_state.last_is_correct

    if correct is True:
        st.success("回答正确 ✅")

    elif correct is False:
        # 单选/多选显示正确答案；主观题给提示
        if qtype == "单选题":
            st.error(f"回答错误 ❌，正确答案是：{q.get('answer','（暂无答案）')}")
        elif qtype == "多选题":
            st.error(f"回答错误 ❌，正确答案是：{q.get('answer','（暂无答案）')}")
        else:
            st.error("未匹配到标准答案（主观题为粗略判定，仅供自查）❌")

    else:
        st.warning("本题暂无可自动判定的标准答案，未计分。")

    with st.expander("📌 查看解析 / 参考答案", expanded=True):
        st.info(q.get("explanation", "（暂无解析）"))

    if st.button("➡️ 下一题"):
        st.session_state.current_index += 1
        st.session_state.submitted = False
        st.session_state.last_is_correct = None
        save_current_state()
        st.rerun()



st.divider()
st.caption("钱靖 • 病理学刷题。")





